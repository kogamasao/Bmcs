# 詳細設計書 - 成績集計

## 1. 成績集計 (G070)

### 1.1 画面レイアウト
#### 検索条件
| 項目名 | 物理名 | 型 | 備考 |
| --- | --- | --- | --- |
| 年 | Year | Select | |
| 試合種別 | GameClass | Select | 公式戦、練習試合など |
| カテゴリ | TeamCategoryClass | Select | |
| 使用球 | UseBallClass | Select | |
| 規定試合数 | IsIgnoreRegulationGames | Select | 規定数未満を含めるか |
| 規定投球回 | IsIgnoreRegulationInnings | Select | 規定数未満を含めるか |
| 規定打席 | IsIgnoreRegulationAtBatting | Select | 規定数未満を含めるか |

#### 一覧表示 (チーム/投手/野手)
- **チーム成績**: 順位、チーム名、試合数、勝敗分、勝率、得点、失点、本塁打、盗塁、打率、防御率など。
- **投手成績**: 順位、チーム名、投手名、勝利数、防御率、登板数、完投、完封、奪三振、WHIPなど。
- **野手成績**: 順位、チーム名、野手名、試合数、打率、安打、本塁打、打点、盗塁、OPSなど。

### 1.2 処理ロジック
1.  **データ取得**:
    - 検索条件に一致する「試合終了」ステータスの試合データ (`Games`) を取得。
    - 関連する投手成績 (`GameScorePitchers`)、野手成績 (`GameScoreFielders`) を取得。
    - 公開フラグ (`PublicFLG`) に基づき、公開データのみまたは自チームデータを含めて取得。
2.  **集計処理**:
    - 取得した詳細データを元に、チームごと、選手ごとの成績を合算・計算。
    - **規定数計算**: 試合数などから規定投球回、規定打席を算出。
3.  **ランキング・ソート**:
    - `ScorePageClass` (Index) の場合、各部門（勝率、打率、防御率など）の上位10件を表示。
    - 詳細モード (Team/Pitcher/Fielder) の場合、指定されたソート項目 (`SortItem`) で並び替え。
    - 規定数未満のデータを除外するオプション (`IsIgnoreRegulation...`) を適用。
4.  **ページネーション**:
    - 詳細モードではページネーション（20件/ページ）を適用。
